//ceebox
/*
 * CeeBox 2.0.11 jQuery Plugin (minimized version)
 * Requires jQuery 1.3.2 and swfobject.jquery.js plugin to work
 * Code hosted on GitHub (http://github.com/catcubed/ceebox) Please visit there for version history information
 * By Colin Fahrion (http://www.catcubed.com)
 * Inspiration for ceebox comes from Thickbox (http://jquery.com/demo/thickbox/) and Videobox (http://videobox-lb.sourceforge.net/)
 * However, along the upgrade path ceebox has morphed a long way from those roots.
 * Copyright (c) 2009 Colin Fahrion
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*/

(function(b){function y(c,a,d){n=new (function(){var e="";b.each(b.fn.ceebox.videos,function(g,f){if(f.siteRgx!=null&&typeof f.siteRgx!="string"){g=String(f.siteRgx);e=e+g.slice(1,g.length-2)+"|"}});this.vidRegex=new RegExp(e+"\\.swf$","i")});n.userAgent=navigator.userAgent;b(".cee_close").die().live("click",function(){b.fn.ceebox.closebox();return false});b(c).contents().is("html")||b(c).each(function(e){ceeboxLinkSort(this,e,a,d)});b(c).live("click",function(e){var g=b(e.target).closest("a[href],area[href],input[href]"),
f=g.data("ceebox");if(f){var k=f.opts?b.extend({},a,f.opts):a;b.fn.ceebox.overlay(k);if(f.type=="image"){var i=new Image;i.onload=function(){var l=i.width,j=i.height;k.imageWidth=s(l,b.fn.ceebox.defaults.imageWidth);k.imageHeight=s(j,b.fn.ceebox.defaults.imageHeight);k.imageRatio=l/j;b.fn.ceebox.popup(g,b.extend(k,{type:f.type},{gallery:f.gallery}))};i.src=b(g).attr("href")}else b.fn.ceebox.popup(g,b.extend(k,{type:f.type},{gallery:f.gallery}));return false}})}function z(c,a){c=c.match(a);a=[];var d=
c.length;if(d>1){a[0]=c[0];a[1]=c[1];a[2]=d==2?c[0]:c[2];a[3]=d==4?c[3]:c[1]}else a=[c,c,c,c];return a}function D(c,a,d){document.onkeydown=function(e){e=e||window.event;e=e.keyCode||e.which;switch(e){case 13:return false;case 27:b.fn.ceebox.closebox(d);document.onkeydown=null;break;case 188:case 37:c&&c.prevId!=null&&t(a,c.prevId,d);break;case 190:case 39:c&&c.nextId!=null&&t(a,c.nextId,d);break}}}function E(c,a,d){function e(j,m){var o,r=i,p=r-2E3;j=="prev"?(o=[{left:0},"left"]):(o=[{right:0},x=
"right"]);var q=function(u){return b.extend({zIndex:105,width:g+l,height:f+l,position:"absolute",top:k,backgroundPosition:o[1]+" "+u+l},o[0])};b("<a href='#'></a>").text(j).attr({id:"cee_"+j}).css(q(p)).hover(function(){b(this).css(q(r))},function(){b(this).css(q(p))}).one("click",function(u){u.preventDefault();t(a,m,d.fadeOut)}).appendTo("#cee_box")}var g=parseInt(d.width/2),f=d.height-d.titleHeight-2*d.padding,k=d.padding,i=f/2,l="px";if(d.type=="video"||d.type=="html"){g=60;f=80;k=parseInt((d.height-
d.titleHeight-10)/2);i=24}if(d.type=="video")k=parseInt((k*2-2*d.padding)/2);c.prevId!=null&&e("prev",c.prevId);c.nextId&&e("next",c.nextId);b("#cee_title").append("<div id='cee_count'>Item "+(c.gNum+1)+" of "+c.gLen+"</div>")}function t(c,a,d){b("#cee_prev,#cee_next").unbind().click(function(){return false});document.onkeydown=null;var e=b("#cee_box").children(),g=e.length;e.fadeOut(d,function(){b(this).remove();this==e[g-1]&&c.eq(a).trigger("click")})}function s(c,a){return c&&c<a||!a?c:a}function v(c){return typeof c==
"function"}function F(c){var a=c.length;return a>1?c[a-1]:c}b.ceebox={version:"2.1"};b.fn.ceebox=function(c){c=b.extend({selector:b(this).selector},b.fn.ceebox.defaults,c);var a=this,d=b(this).selector;c.videoJSON?b.getJSON(c.videoJSON,function(e){b.extend(b.fn.ceebox.videos,e);y(a,c,d)}):y(a,c,d);return this};b.fn.ceebox.defaults={html:true,image:true,video:true,modal:false,titles:true,htmlGallery:true,imageGallery:true,videoGallery:true,videoWidth:false,videoHeight:false,videoRatio:"16:9",htmlWidth:false,
htmlHeight:false,htmlRatio:false,imageWidth:false,imageHeight:false,animSpeed:"normal",easing:"swing",fadeOut:400,fadeIn:400,overlayColor:"#000",overlayOpacity:0.8,boxColor:"",textColor:"",borderColor:"",borderWidth:"3px",padding:15,margin:150,onload:null,unload:null,videoJSON:null};b.fn.ceebox.ratios={"4:3":1.333,"3:2":1.5,"16:9":1.778,"1:1":1,square:1};b.fn.ceebox.relMatch={width:/(?:width:)([0-9]+)/i,height:/(?:height:)([0-9]+)/i,ratio:/(?:ratio:)([0-9\.:]+)/i,modal:/modal:true/i,nonmodal:/modal:false/i,
videoSrc:/(?:videoSrc:)(http:[\/\-\._0-9a-zA-Z:]+)/i,videoId:/(?:videoId:)([\-\._0-9a-zA-Z:]+)/i};b.fn.ceebox.loader="<div id='cee_load' style='z-index:105;top:50%;left:50%;position:fixed'></div>";b.fn.ceebox.videos={base:{param:{wmode:"transparent",allowFullScreen:"true",allowScriptAccess:"always"},flashvars:{autoplay:true}},facebook:{siteRgx:/facebook\.com\/video/i,idRgx:/(?:v=)([a-zA-Z0-9_]+)/i,src:"http://www.facebook.com/v/[id]"},youtube:{siteRgx:/youtube\.com\/watch/i,idRgx:/(?:v=)([a-zA-Z0-9_\-]+)/i,
src:"http://www.youtube.com/v/[id]&hl=en&fs=1&autoplay=1"},metacafe:{siteRgx:/metacafe\.com\/watch/i,idRgx:/(?:watch\/)([a-zA-Z0-9_]+)/i,src:"http://www.metacafe.com/fplayer/[id]/.swf"},google:{siteRgx:/google\.com\/videoplay/i,idRgx:/(?:id=)([a-zA-Z0-9_\-]+)/i,src:"http://video.google.com/googleplayer.swf?docId=[id]&hl=en&fs=true",flashvars:{playerMode:"normal",fs:true}},spike:{siteRgx:/spike\.com\/video|ifilm\.com\/video/i,idRgx:/(?:\/)([0-9]+)/i,src:"http://www.spike.com/efp",flashvars:{flvbaseclip:"[id]"}},
vimeo:{siteRgx:/vimeo\.com\/[0-9]+/i,idRgx:/(?:\.com\/)([a-zA-Z0-9_]+)/i,src:"http://www.vimeo.com/moogaloop.swf?clip_id=[id]&server=vimeo.com&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1"},dailymotion:{siteRgx:/dailymotion\.com\/video/i,idRgx:/(?:video\/)([a-zA-Z0-9_]+)/i,src:"http://www.dailymotion.com/swf/[id]&related=0&autoplay=1"},cnn:{siteRgx:/cnn\.com\/video/i,idRgx:/(?:\?\/video\/)([a-zA-Z0-9_\/\.]+)/i,src:"http://i.cdn.turner.com/cnn/.element/apps/cvp/3.0/swf/cnn_416x234_embed.swf?context=embed&videoId=[id]",
width:416,height:374}};b.fn.ceebox.overlay=function(c){c=b.extend({width:60,height:30,type:"html"},b.fn.ceebox.defaults,c);b("#cee_overlay").size()==0&&b("<div id='cee_overlay'></div>").css({opacity:c.overlayOpacity,position:"absolute",top:0,left:0,backgroundColor:c.overlayColor,width:"100%",height:b(document).height(),zIndex:100}).appendTo(b("body"));if(b("#cee_box").size()==0){var a=A(c);a={position:a.position,zIndex:102,top:"50%",left:"50%",height:c.height+"px",width:c.width+"px",marginLeft:a.mleft+
"px",marginTop:a.mtop+"px",opacity:0,borderWidth:c.borderWidth,borderColor:c.borderColor,backgroundColor:c.boxColor,color:c.textColor};b("<div id='cee_box'></div>").css(a).appendTo("body").animate({opacity:1},c.animSpeed,function(){b("#cee_overlay").addClass("cee_close")})}b("#cee_box").removeClass().addClass("cee_"+c.type);b("#cee_load").size()==0&&b(b.fn.ceebox.loader).appendTo("body");b("#cee_load").show("fast").animate({opacity:1},"fast")};b.fn.ceebox.popup=function(c,a){var d=B(a.margin);a=b.extend({width:d.width,
height:d.height,modal:false,type:"html",onload:null},b.fn.ceebox.defaults,a);var e,g;if(b(c).is("a,area,input")&&(a.type=="html"||a.type=="image"||a.type=="video")){if(a.gallery)g=b(a.selector).eq(a.gallery.parentId).find("a[href],area[href],input[href]");C[a.type].prototype=new G(c,a);d=new C[a.type];c=d.content;a.action=d.action;a.modal=d.modal;if(a.titles){a.titleHeight=b(d.titlebox).contents().contents().wrap("<div></div>").parent().attr("id","ceetitletest").css({position:"absolute",top:"-300px",
width:d.width+"px"}).appendTo("body").height();b("#ceetitletest").remove();a.titleHeight=a.titleHeight>=10?a.titleHeight+20:30}else a.titleHeight=0;a.width=d.width+2*a.padding;a.height=d.height+a.titleHeight+2*a.padding}b.fn.ceebox.overlay(a);n.action=a.action;n.onload=a.onload;n.unload=a.unload;d=A(a);d={marginLeft:d.mleft,marginTop:d.mtop,width:a.width+"px",height:a.height+"px",borderWidth:a.borderWidth};if(a.borderColor){var f=/#[1-90a-f]+/gi;f=z(a.borderColor,f);d=b.extend(d,{borderTopColor:f[0],
borderRightColor:f[1],borderBottomColor:f[2],borderLeftColor:f[3]})}d=a.textColor?b.extend(d,{color:a.textColor}):d;d=a.boxColor?b.extend(d,{backgroundColor:a.boxColor}):d;b("#cee_box").animate(d,a.animSpeed,a.easing,function(){var k=b(this).append(c).children().hide(),i=k.length,l=true;k.fadeIn(a.fadeIn,function(){if(b(this).is("#cee_iframeContent"))l=false;l&&this==k[i-1]&&b.fn.ceebox.onload()});if(a.modal==true)b("#cee_overlay").removeClass("cee_close");else{b("<a href='#' id='cee_closeBtn' class='cee_close' title='Close'>close</a>").prependTo("#cee_box");
a.gallery&&E(a.gallery,g,a);D(e,g,a.fadeOut)}})};b.fn.ceebox.closebox=function(c){c=c||400;b("#cee_box").fadeOut(c);b("#cee_overlay").fadeOut(typeof c=="number"?c*2:"slow",function(){b("#cee_box,#cee_overlay,#cee_HideSelect,#cee_load").unbind().trigger("unload").remove();if(v(n.unload)){n.unload();n.unload=null}});document.onkeydown=null};b.fn.ceebox.onload=function(){b("#cee_load").hide(300).fadeOut(600,function(){b(this).remove()});if(v(n.action)){n.action();n.action=null}if(v(n.onload)){n.onload();
n.onload=null}};var n;ceeboxLinkSort=function(c,a,d){var e,g=[],f=[],k=0;b(c).is("a[href],area[href],input[href]")?(e=b(c)):(e=b(c).find("a[href],area[href],input[href]"));var i={image:function(j){return j.match(/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/i)||false},video:function(j,m){return m&&m.match(/^video$/i)?true:j.match(n.vidRegex)||false},html:function(){return true}};e.each(function(j){var m=this,o=b.metadata?b(m).metadata():false,r=o?b.extend({},d,o):d;b.each(i,function(p){if(i[p](b(m).attr("href"),
b(m).attr("rel"))&&r[p]){var q=false;if(d.htmlGallery==true&&p=="html"||d.imageGallery==true&&p=="image"||d.videoGallery==true&&p=="video"){f[f.length]=j;q=true}g[g.length]={linkObj:m,type:p,gallery:q,linkOpts:r};return false}})});var l=f.length;b.each(g,function(j){if(g[j].gallery){var m={parentId:a,gNum:k,gLen:l};if(k>0)m.prevId=f[k-1];if(k<l-1)m.nextId=f[k+1];k++}b.data(g[j].linkObj,"ceebox",{type:g[j].type,opts:g[j].linkOpts,gallery:m})})};var G=function(c,a){function d(m){var o=m.length;return o>
1?m[o-1]:m}var e=a.type,g={image:[a.imageWidth,a.imageHeight,a.imageRatio||a.imageWidth/a.imageHeight],video:[a.videoWidth,a.videoHeight,a.videoRatio],html:[a.htmlWidth,a.htmlHeight,a.htmlRatio]},f=g[e][0],k=g[e][1],i=g[e][2],l=b(c).attr("rel");if(l&&l!=""){var j={};b.each(b.fn.ceebox.relMatch,function(m,o){j[m]=o.exec(l)});if(j.modal)a.modal=true;if(j.nonmodal)a.modal=false;if(j.width)f=Number(d(j.width));if(j.height)k=Number(d(j.height));if(j.ratio){i=d(j.ratio);i=Number(i)?Number(i):String(i)}if(j.videoSrc)this.videoSrc=
String(d(j.videoSrc));if(j.videoId)this.videoId=String(d(j.videoId))}e=B(a.margin);f=s(f,e.width);k=s(k,e.height);if(i){if(!Number(i)){b.each(b.fn.ceebox.ratios,function(m,o){if(i==m){i=o;return false}});i=Number(i)||1}if(f/k>i)f=parseInt(k*i,10);if(f/k<i)k=parseInt(f/i,10)}this.modal=a.modal;this.href=b(c).attr("href");this.title=b(c).attr("title")||c.t||"";this.titlebox=a.titles?"<div id='cee_title'><h2>"+this.title+"</h2></div>":"";this.width=f;this.height=k;this.rel=l},C={image:function(){this.content=
"<img id='cee_img' src='"+this.href+"' width='"+this.width+"' height='"+this.height+"' alt='"+this.title+"'/>"+this.titlebox},video:function(){var c="",a=new (function(e){var g=this,f=e.videoId;g.flashvars=g.param={};g.src=e.videoSrc||e.href;g.width=e.width;g.height=e.height;b.each(b.fn.ceebox.videos,function(k,i){if(i.siteRgx!=null&&typeof i.siteRgx!="string"&&i.siteRgx.test(e.href)){if(i.idRgx){i.idRgx=new RegExp(i.idRgx);f=i.idRgx.exec(e.href);f=String(F(f))}g.src=i.src?i.src.replace("[id]",f):
g.src;i.flashvars&&b.each(i.flashvars,function(l,j){if(typeof j=="string")g.flashvars[l]=j.replace("[id]",f)});i.param&&b.each(i.param,function(l,j){if(typeof j=="string")g.param[l]=j.replace("[id]",f)});g.width=i.width||g.width;g.height=i.height||g.height;g.site=k}})})(this);if(b.flash.hasVersion(8)){this.width=a.width;this.height=a.height;this.action=function(){b("#cee_vid").flash({swf:a.src,params:b.extend(b.fn.ceebox.videos.base.param,a.param),flashvars:b.extend(b.fn.ceebox.videos.base.flashvars,
a.flashvars),width:a.width,height:a.height})}}else{this.width=400;this.height=200;if(n.userAgent.match(/iPhone/i)||n.userAgent.match(/iPod/i)&&a.site=="youtube"){var d=this.href;this.action=function(){b.fn.ceebox.closebox();window.location=d}}else{a.site=a.site||"SWF file";c="<p style='margin:20px'>Adobe Flash 8 or higher is required to view this movie. You can either:</p><ul><li>Follow link to <a href='"+this.href+"'>"+a.site+" </a></li><li>or <a href='http://www.adobe.com/products/flashplayer/'>Install Flash</a></li><li> or <a href='#' class='cee_close'>Close This Popup</a></li></ul>"}}this.content=
"<div id='cee_vid' style='width:"+this.width+"px;height:"+this.height+"px;'>"+c+"</div>"+this.titlebox},html:function(){var c=this.href,a=this.rel;a=[c.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i),c.match(/^http:+/),a?a.match(/^iframe/):false];if(document.domain==a[0]&&a[1]&&!a[2]||!a[1]&&!a[2]){var d=c;if(a=c.match(/#[a-zA-Z0-9_\-]+/)){d=c.split("#")[0];d=String(d+" "+a)}this.action=function(){b("#cee_ajax").load(d)};this.content=this.titlebox+"<div id='cee_ajax' style='width:"+(this.width-30)+"px;height:"+
(this.height-20)+"px'></div>"}else{b("#cee_iframe").remove();this.content=this.titlebox+"<iframe frameborder='0' hspace='0' src='"+c+"' id='cee_iframeContent' name='cee_iframeContent"+Math.round(Math.random()*1E3)+"' onload='jQuery.fn.ceebox.onload()' style='width:"+this.width+"px;height:"+this.height+"px;' > </iframe>"}}},B=function(c){var a=document.documentElement;c=c||100;this.width=(window.innerWidth||self.innerWidth||a&&a.clientWidth||document.body.clientWidth)-c;this.height=(window.innerHeight||
self.innerHeight||a&&a.clientHeight||document.body.clientHeight)-c;return this},A=function(c){var a="fixed",d=0,e=/[0-9]+/g;e=z(c.borderWidth,e);if(!window.XMLHttpRequest){b("#cee_HideSelect")===null&&b("body").append("<iframe id='cee_HideSelect'></iframe>");a="absolute";d=parseInt(document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,10)}this.mleft=parseInt(-1*(c.width/2+Number(e[3])),10);this.mtop=parseInt(-1*(c.height/2+Number(e[0])),10)+d;this.position=a;return this}})(jQuery);