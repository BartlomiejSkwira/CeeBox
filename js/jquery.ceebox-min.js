//ceebox
/*
 * CeeBox 2.0.3 jQuery Plugin (minimized version)
 * Requires jQuery 1.3.2 and swfobject.jquery.js plugin to work
 * Code hosted on GitHub (http://github.com/catcubed/ceebox) Please visit there for version history information
 * By Colin Fahrion (http://www.catcubed.com)
 * Inspiration for ceebox comes from Thickbox (http://jquery.com/demo/thickbox/) and Videobox (http://videobox-lb.sourceforge.net/)
 * However, along the upgrade path ceebox has morphed a long way from those roots.
 * Copyright (c) 2009 Colin Fahrion
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*/

(function(c){function A(){m=new (function(){var b="";c.each(c.fn.ceebox.videos,function(a,d){if(d.siteRgx!=null&&typeof d.siteRgx=="object"){a=String(d.siteRgx);b=b+a.slice(1,a.length-2)+"|"}});this.vidRegex=new RegExp(b+".swf$","i")})}function u(b,a){b=b.match(a);a=[];var d=b.length;if(d>1){a[0]=b[0];a[1]=b[1];a[2]=d==2?b[0]:b[2];a[3]=d==4?b[3]:b[1]}else a=[b,b,b,b];return a}function B(b,a,d){document.onkeydown=function(f){f=f||window.event;f=f.keyCode||f.which;switch(f){case 27:c.fn.ceebox.closebox(d);
document.onkeydown=null;break;case 188:case 37:b&&b.prevId!=null&&s(a,b.prevId,d);break;case 190:case 39:b&&b.nextId!=null&&s(a,b.nextId,d);break}}}function C(b,a,d){function f(e,l){var k,n=g-2E3+"px",q=g+"px";e=="prev"?(k=[{left:0},"left"]):(k=[{right:0},x="right"]);function o(p){return c.extend({width:i+"px",height:h+"px",position:"absolute",top:j},k[0],{backgroundPosition:k[1]+" "+p})}c("<a href='#'></a>").text(e).attr({id:"cee_"+e}).css(o(n)).hover(function(){c(this).css(o(q))},function(){c(this).css(o(n))}).one("click",
function(p){p.preventDefault();s(a,l,d.fadeOut)}).appendTo("#cee_box")}var i=parseInt(d.width/2),h=d.height-d.titleHeight-2*d.padding,j=d.padding,g=h/2;if(d.type=="video"||d.type=="html"){i=60;h=80;j=parseInt((d.height-d.titleHeight-2*d.padding-10)/2);g=24}if(d.type=="html")j=parseInt((d.height-d.titleHeight-10)/2);b.prevId!=null&&f("prev",b.prevId);b.nextId&&f("next",b.nextId);c("#cee_title").append("<div id='cee_count'>Item "+(b.cbId+1)+" of "+b.cbLen+"</div>")}function s(b,a,d){c("#cee_prev,#cee_next").unbind().click(function(){return false});
document.onkeydown=null;var f=c("#cee_box").children(),i=f.length;f.fadeOut(d,function(){c(this).remove();this==f[i-1]&&b.eq(a).trigger("click")})}function r(b,a){return b&&b<a||!a?b:a}function t(b){return typeof b=="function"}c.ceebox={version:"2.0.5"};c.fn.ceebox=function(b){b=c.extend({selector:c(this).selector},c.fn.ceebox.defaults,b);A();c(".cee_close").die().live("click",function(){c.fn.ceebox.closebox();return false});c(this).each(function(a){c.ceebox(this,a,b)});return this};c.fn.ceebox.defaults=
{html:true,image:true,video:true,modal:false,titles:true,htmlGallery:true,imageGallery:true,videoGallery:true,videoWidth:false,videoHeight:false,videoRatio:"16:9",htmlWidth:false,htmlHeight:false,htmlRatio:false,imageWidth:false,imageHeight:false,animSpeed:"normal",easing:"swing",fadeOut:400,fadeIn:400,overlayColor:"#000",overlayOpacity:0.8,boxColor:"",textColor:"",borderColor:"",borderWidth:"3px",padding:15,margin:150,onload:null,unload:null};c.fn.ceebox.ratios={"4:3":1.667,"3:2":1.5,"16:9":1.778,
"1:1":1,square:1};c.fn.ceebox.relMatch={width:/(?:width:)([0-9]+)/i,height:/(?:height:)([0-9]+)/i,modal:/modal:true/i,nonmodal:/modal:false/i,videoSrc:/(?:videoSrc:)(http:[\/\-\._0-9a-zA-Z:]+)/i};c.fn.ceebox.loader="<div id='cee_load' style='z-index:105;top:50%;left:50%;position:fixed'></div>";c.fn.ceebox.videos={base:{param:{wmode:"transparent",allowFullScreen:"true",allowScriptAccess:"always"},flashvars:{autoplay:true}},facebook:{siteRgx:/facebook\.com\/video/i,idRgx:/(?:v=)([a-zA-Z0-9_]+)/g,src:"http://www.facebook.com/v/[id]"},
youtube:{siteRgx:/youtube\.com\/watch/i,idRgx:/(?:v=)([a-zA-Z0-9_]+)/g,src:"http://www.youtube.com/v/[id]&hl=en&fs=1&autoplay=1"},metacafe:{siteRgx:/metacafe\.com\/watch/i,idRgx:/(?:watch\/)([a-zA-Z0-9_]+)/g,src:"http://www.metacafe.com/fplayer/[id]/.swf"},google:{siteRgx:/google\.com\/videoplay/i,idRgx:/(?:id=)([a-zA-Z0-9_]+)/g,src:"http://www.google.com/googleplayer.swf?docId=[id]&hl=en&fs=true",flashvars:{playerMode:"normal",fs:true}},spike:{siteRgx:/spike\.com\/video|ifilm\.com\/video/i,idRgx:/(?:\/)([0-9]+)/g,
src:"http://www.spike.com/efp",flashvars:{flvbaseclip:"[id]"}},vimeo:{siteRgx:/vimeo\.com\/[0-9]+/i,idRgx:/(?:\.com\/)([a-zA-Z0-9_]+)/g,src:"http://www.vimeo.com/moogaloop.swf?clip_id=[id]&server=vimeo.com&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1"},dailymotion:{siteRgx:/dailymotion\.com\/video/i,idRgx:/(?:video\/)([a-zA-Z0-9_]+)/g,src:"http://www.dailymotion.com/swf/[id]&related=0&autoplay=1"},cnn:{siteRgx:/cnn\.com\/video/i,idRgx:/(?:\?\/video\/)([a-zA-Z0-9_\/\.]+)/g,src:"http://i.cdn.turner.com/cnn/.element/apps/cvp/3.0/swf/cnn_416x234_embed.swf?context=embed&videoId=[id]",
width:416,height:374}};c.ceebox=function(b,a,d){var f,i=[],h=0;c(b).is("a[href],area[href],input[href]")?(f=c(b)):(f=c(b).children().andSelf().find("a[href],area[href],input[href]"));var j={image:function(e){return e.match(/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/i)||false},video:function(e){return e.match(m.vidRegex)||false},html:function(){return true}};f.each(function(e){var l=this,k=c.metadata?c.extend({},d,c(l).metadata()):d;c.each(j,function(n){if(j[n](c(l).attr("href"))&&k[n]){if(d.htmlGallery==
true&&n=="html"){i[h]=e;h++}else if(d.imageGallery==true&&n=="image"){i[h]=e;h++}else if(d.videoGallery==true&&n=="video"){i[h]=e;h++}c(l).unbind("click").bind("click",function(q){q.preventDefault();q.stopPropagation();c.fn.ceebox.overlay(k);if(n=="image"){var o=new Image;o.onload=function(){var p=o.width,v=o.height;k.imageWidth=r(p,c.fn.ceebox.defaults.imageWidth);k.imageHeight=r(v,c.fn.ceebox.defaults.imageHeight);k.imageRatio=p/v;c.fn.ceebox.popup(l,c.extend(k,{type:n}))};o.src=c(l).attr("href")}else c.fn.ceebox.popup(l,
c.extend(k,{type:n}))});return false}})});var g=i.length;c.each(i,function(e){var l=f[i[e]];if(g>1){var k={parentId:a,cbId:e,cbLen:g};if(e>0)k.prevId=i[e-1];if(e<g-1)k.nextId=i[e+1];c.data(l,"ceeboxGallery",k)}})};c.fn.ceebox.overlay=function(b){b=c.extend({width:60,height:30,type:"html"},c.fn.ceebox.defaults,b);c("#cee_overlay").size()==0&&c("<div id='cee_overlay'></div>").css({opacity:b.overlayOpacity,position:"absolute",top:0,left:0,backgroundColor:b.overlayColor,width:"100%",height:c(document).height(),
zIndex:100}).appendTo(c("body"));if(c("#cee_box").size()==0){var a=w(b);a={position:a.position,zIndex:102,top:"50%",left:"50%",height:b.height+"px",width:b.width+"px",marginLeft:a.mleft+"px",marginTop:a.mtop+"px",opacity:0,borderWidth:b.borderWidth,borderColor:b.borderColor,backgroundColor:b.boxColor,color:b.textColor};c("<div id='cee_box'></div>").css(a).appendTo("body").animate({opacity:1},b.animSpeed,function(){c("#cee_overlay").addClass("cee_close")})}c("#cee_box").removeClass().addClass("cee_"+
b.type);c("#cee_load").size()==0&&c(c.fn.ceebox.loader).appendTo("body");c("#cee_load").show("fast").animate({opacity:1},"fast")};c.fn.ceebox.popup=function(b,a){var d=y(a.margin);a=c.extend({width:d.width,height:d.height,modal:false,type:"html",onload:null},c.fn.ceebox.defaults,a);var f,i;if(c(b).is("a,area,input")&&(a.type=="html"||a.type=="image"||a.type=="video")){if(f=c.data(b,"ceeboxGallery"))i=c(a.selector).eq(f.parentId).contents().andSelf().find("[href]");z[a.type].prototype=new D(b,a);d=
new z[a.type];b=d.content;a.action=d.action;a.modal=d.modal;if(a.titles){a.titleHeight=c(d.titlebox).contents().contents().wrap("<div></div>").parent().attr("id","ceetitletest").css({position:"absolute",top:"-300px",width:d.width+"px"}).appendTo("body").height();c("#ceetitletest").remove();a.titleHeight=a.titleHeight>=10?a.titleHeight+20:30}else a.titleHeight=0;a.width=d.width+2*a.padding;a.height=d.height+a.titleHeight+2*a.padding}c.fn.ceebox.overlay(a);m.action=a.action;m.onload=a.onload;m.unload=
a.unload;d=w(a);d={marginLeft:d.mleft,marginTop:d.mtop,width:a.width+"px",height:a.height+"px",borderWidth:a.borderWidth};if(a.borderColor){var h=/#[1-90a-f]+/gi;h=u(a.borderColor,h);d=c.extend(d,{borderTopColor:h[0],borderRightColor:h[1],borderBottomColor:h[2],borderLeftColor:h[3]})}d=a.textColor?c.extend(d,{color:a.textColor}):d;d=a.boxColor?c.extend(d,{backgroundColor:a.boxColor}):d;c("#cee_box").animate(d,a.animSpeed,a.easing,function(){var j=c(this).append(b).children().hide(),g=j.length,e=true;
j.fadeIn(a.fadeIn,function(){if(c(this).is("#cee_iframeContent"))e=false;e&&this==j[g-1]&&c.fn.ceebox.onload()});if(a.modal==true)c("#cee_overlay").removeClass("cee_close");else{c("<a href='#' id='cee_closeBtn' class='cee_close' title='Close'>close</a>").prependTo("#cee_box");f&&C(f,i,a);B(f,i,a.fadeOut)}})};c.fn.ceebox.closebox=function(b){b=b||400;c("#cee_box").fadeOut(b);c("#cee_overlay").fadeOut(typeof b=="number"?b*2:"slow",function(){c("#cee_box,#cee_overlay,#cee_HideSelect,#cee_load").unbind().trigger("unload").remove();
if(t(m.unload)){m.unload();m.unload=null}});document.onkeydown=null};c.fn.ceebox.onload=function(){c("#cee_load").hide(300).fadeOut(600,function(){c(this).remove()});if(t(m.action)){m.action();m.action=null}if(t(m.onload)){m.onload();m.onload=null}};var m;function D(b,a){var d=a.type,f={image:[a.imageWidth,a.imageHeight,a.imageRatio||a.imageWidth/a.imageHeight],video:[a.videoWidth,a.videoHeight,a.videoRatio],html:[a.htmlWidth,a.htmlHeight,a.htmlRatio]},i=f[d][0],h=f[d][1],j=f[d][2],g=c(b).attr("rel");
if(g&&g!=""){var e={};c.each(c.fn.ceebox.relMatch,function(l,k){e[l]=k.exec(g)});if(e.modal)this.modal=true;if(e.nonmodal)this.modal=false;if(e.width){d=e.width.length;i=d>1?Number(e.width[d-1]):Number(e.width)}if(e.height){d=e.height.length;h=e.height.length>1?Number(e.height[d-1]):Number(e.height)}if(e.videoSrc){d=e.videoSrc.length;this.videoSrc=String(e.videoSrc[d-1])}}d=y(a.margin);i=r(i,d.width);h=r(h,d.height);if(j){if(!Number(j)){c.each(c.fn.ceebox.ratios,function(l,k){if(j==l){j=k;return false}});
j=Number(j)||1}if(i/h>j)i=parseInt(h*j,10);if(i/h<j)h=parseInt(i/j,10)}this.modal=this.modal||a.modal;this.href=c(b).attr("href");this.title=c(b).attr("title");this.titlebox=a.titles?"<div id='cee_title'><h2>"+this.title+"</h2></div>":"";this.width=i;this.height=h;this.rel=g}var z={image:function(){this.content="<img id='cee_img' src='"+this.href+"' width='"+this.width+"' height='"+this.height+"' alt='"+this.title+"'/>"+this.titlebox},video:function(){var b=new (function(d,f){var i=this,h;c.each(c.fn.ceebox.videos,
function(j,g){if(g.siteRgx!=null&&typeof g.siteRgx=="object"&&g.siteRgx.test(d)){if(g.idRgx){g.idRgx=new RegExp(g.idRgx);h=String(g.idRgx.exec(d)[1])}g.src=g.src?g.src.replace("[id]",h):f;g.flashvars&&c.each(g.flashvars,function(e,l){g.flashvars[e]=l.replace("[id]",h)});g.param&&c.each(g.param,function(e,l){g.param[e]=l.replace("[id]",h)});c.extend(i,g)}})})(this.href,this.videoSrc),a=c.fn.ceebox.videos.base;b.src=b.src||this.href;b.param=c.extend(a.param,b.param);b.flashvars=c.extend(a.flashvars,
b.flashvars);b.width=this.width=b.width?b.width:this.width;b.height=this.height=b.height?b.height:this.height;this.action=function(){c("#cee_vid").flash({swf:b.src,params:b.param,flashvars:b.flashvars,width:b.width,height:b.height})};this.content="<div id='cee_vid' style='width:"+this.width+"px;height:"+this.height+"px'></div>"+this.titlebox},html:function(){var b=this.href,a=this.rel;a=[b.match(/\w+\.com/i),b.match(/^http:+/),a?a.match(/^iframe/):false];if(document.domain==a[0]&&a[1]&&!a[2]||!a[1]&&
!a[2]){var d=b;if(a=b.match(/#[a-z_A-Z1-9]+/)){d=b.split("#")[0];d=String(d+" "+a)}this.action=function(){c("#cee_ajax").load(d)};this.content=this.titlebox+"<div id='cee_ajax' style='width:"+(this.width-30)+"px;height:"+(this.height-20)+"px'></div>"}else{c("#cee_iframe").remove();this.content=this.titlebox+"<iframe frameborder='0' hspace='0' src='"+b+"' id='cee_iframeContent' name='cee_iframeContent"+Math.round(Math.random()*1E3)+"' onload='$.fn.ceebox.onload()' style='width:"+this.width+"px;height:"+
this.height+"px;' > </iframe>"}}};function y(b){var a=document.documentElement;b=b||100;this.width=(window.innerWidth||self.innerWidth||a&&a.clientWidth||document.body.clientWidth)-b;this.height=(window.innerHeight||self.innerHeight||a&&a.clientHeight||document.body.clientHeight)-b;return this}function w(b){var a="fixed",d=0,f=/[0-9]+/g;f=u(b.borderWidth,f);if(!window.XMLHttpRequest){c("#cee_HideSelect")===null&&c("body").append("<iframe id='cb.HideSelect'></iframe>");a="absolute";d=parseInt(document.documentElement&&
document.documentElement.scrollTop||document.body.scrollTop,10)}this.mleft=parseInt(-1*(b.width/2+Number(f[3])),10);this.mtop=parseInt(-1*(b.height/2+Number(f[0])),10)+d;this.position=a;return this}})(jQuery);