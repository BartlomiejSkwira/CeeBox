//ceebox
/*
 * CeeBox 2.1.5.2 jQuery Plugin (minimized version)
 * Requires jQuery 1.3.2 and swfobject.jquery.js plugin to work
 * Code hosted on GitHub (http://github.com/catcubed/ceebox) Please visit there for version history information
 * By Colin Fahrion (http://www.catcubed.com)
 * Inspiration for ceebox comes from Thickbox (http://jquery.com/demo/thickbox/) and Videobox (http://videobox-lb.sourceforge.net/)
 * However, along the upgrade path ceebox has morphed a long way from those roots.
 * Copyright (c) 2009 Colin Fahrion
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*/

(function(a){function n(d,b,c){h.vidRegex=function(){var b="";a.each(a.fn.ceebox.videos,function(a,d){if(null!==d.siteRgx&&"string"!==typeof d.siteRgx){var c=""+d.siteRgx;b=b+c.slice(1,c.length-2)+"|"}});return RegExp(b+"\\.swf$","i")}();h.userAgent=navigator.userAgent;a(".cee_close").die().live("click",function(){a.fn.ceebox.closebox();return!1});!1!=c&&a(d).each(function(a){s(this,a,b,c)});a(d).live("click",function(d){var c=a(d.target).closest("[href]"),j=c.data("ceebox");if(j){var i=j.opts?a.extend({},
b,j.opts):b;a.fn.ceebox.overlay(i);if("image"==j.type){var f=new Image;f.onload=function(){var b=f.width,d=f.height;i.imageWidth=b&&b<a.fn.ceebox.defaults.imageWidth||!a.fn.ceebox.defaults.imageWidth?b:a.fn.ceebox.defaults.imageWidth;i.imageHeight=d&&d<a.fn.ceebox.defaults.imageHeight||!a.fn.ceebox.defaults.imageHeight?d:a.fn.ceebox.defaults.imageHeight;i.imageRatio=b/d;a.fn.ceebox.popup(c,a.extend(i,{type:j.type},{gallery:j.gallery}))};f.src=a(c).attr("href")}else a.fn.ceebox.popup(c,a.extend(i,
{type:j.type},{gallery:j.gallery}));return!1}})}function p(a){var b=document.documentElement,a=a||100;this.width=(window.innerWidth||self.innerWidth||b&&b.clientWidth||document.body.clientWidth)-a;this.height=(window.innerHeight||self.innerHeight||b&&b.clientHeight||document.body.clientHeight)-a;return this}function q(d){var b="fixed",c=0,e;e=d.borderWidth.match(/[0-9]+/g);var g=[],j=e.length;1<j?(g[0]=e[0],g[1]=e[1],g[2]=2==j?e[0]:e[2],g[3]=4==j?e[3]:e[1]):g=[e,e,e,e];e=g;window.XMLHttpRequest||
(null===a("#cee_HideSelect")&&a("body").append("<iframe id='cee_HideSelect'></iframe>"),b="absolute",c=parseInt(document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,10));this.mleft=parseInt(-1*(d.width/2+Number(e[3])),10);this.mtop=parseInt(-1*(d.height/2+Number(e[0])),10)+c;this.position=b;return this}function t(){document.onkeydown=function(d){d=d||window.event;switch(d.keyCode||d.which){case 13:return!1;case 27:a.fn.ceebox.closebox();document.onkeydown=null;break;
case 188:case 37:a("#cee_prev").trigger("click");break;case 190:case 39:a("#cee_next").trigger("click")}return!0}}function u(d,b,c){function e(d,g){var e,j=f[c.type].bgtop,i=j-2E3;"prev"==d?e=[{left:0},"left"]:e=[{right:0},x="right"];var h=function(b){return a.extend({zIndex:105,width:f[c.type].w+"px",height:f[c.type].h+"px",position:"absolute",top:f[c.type].top,backgroundPosition:e[1]+" "+b+"px"},e[0])};a("<a href='#'></a>").text(d).attr({id:"cee_"+d}).css(h(i)).hover(function(){a(this).css(h(j))},
function(){a(this).css(h(i))}).one("click",function(d){d.preventDefault();(function(b,d,c){a("#cee_prev,#cee_next").unbind().click(function(){return!1});document.onkeydown=null;var e=a("#cee_box").children(),g=e.length;e.fadeOut(c,function(){a(this).remove();this==e[g-1]&&b.eq(d).trigger("click")})})(b,g,c.fadeOut)}).appendTo("#cee_box")}var g=c.height,j=c.titleHeight,i=c.padding,f={image:{w:parseInt(c.width/2,10),h:g-j-2*i,top:i,bgtop:(g-j-2*i)/2},video:{w:60,h:80,top:parseInt((g-j-10-2*i)/2,10),
bgtop:24}};f.html=f.video;0<=d.prevId&&e("prev",d.prevId);d.nextId&&e("next",d.nextId);a("#cee_title").append("<div id='cee_count'>Item "+(d.gNum+1)+" of "+d.gLen+"</div>")}function l(a){return"function"==typeof a}function k(a){var b=a.length;return 1<b?a[b-1]:a}function v(d,b){if(!0===debugging){var c="",e="[ceebox]("+(b||"")+")";a.isArray(d)||"object"==typeof d||"function"==typeof d?a.each(d,function(a,b){c=c+a+":"+b+", "}):c=d;window.console&&window.console.log?window.console.log(e+c):0===a("#debug").size()&&
(a("<ul id='debug'></ul>").appendTo("body").css({border:"1px solid #ccf",position:"fixed",top:"10px",right:"10px",width:"300px",padding:"10px",listStyle:"square"}),a("<li>").css({margin:"0 0 5px"}).appendTo("#debug").append(e).wrapInner("<b></b>").append(" "+c))}}a.ceebox={version:"2.1.5.2"};a.fn.ceebox=function(d){var d=a.extend({selector:a(this).selector},a.fn.ceebox.defaults,d),b=this,c=a(this).selector;d.videoJSON?a.getJSON(d.videoJSON,function(e){a.extend(a.fn.ceebox.videos,e);n(b,d,c)}):n(b,
d,c);return this};a.fn.ceebox.defaults={html:!0,image:!0,video:!0,modal:!1,titles:!0,htmlGallery:!0,imageGallery:!0,videoGallery:!0,videoWidth:!1,videoHeight:!1,videoRatio:"16:9",htmlWidth:!1,htmlHeight:!1,htmlRatio:!1,imageWidth:!1,imageHeight:!1,animSpeed:"normal",easing:"swing",fadeOut:400,fadeIn:400,overlayColor:"#000",overlayOpacity:0.8,boxColor:"",textColor:"",borderWidth:"3px",padding:15,margin:150,onload:null,unload:null,videoJSON:null,iPhoneRedirect:!0};a.fn.ceebox.ratios={"4:3":1.333,"3:2":1.5,
"16:9":1.778,"1:1":1,square:1};a.fn.ceebox.relMatch={width:/(?:width:)([0-9]+)/i,height:/(?:height:)([0-9]+)/i,ratio:/(?:ratio:)([0-9\.:]+)/i,modal:/modal:true/i,nonmodal:/modal:false/i,videoSrc:/(?:videoSrc:)(http:[\/\-\._0-9a-zA-Z:]+)/i,videoId:/(?:videoId:)([\-\._0-9a-zA-Z:]+)/i,start:/(?:start:)([0-9]+)/i};a.fn.ceebox.loader="<div id='cee_load' style='z-index:105;top:50%;left:50%;position:fixed'></div>";a.fn.ceebox.videos={base:{param:{wmode:"transparent",allowFullScreen:"true",allowScriptAccess:"always"},
flashvars:{autoplay:!0}},facebook:{siteRgx:/facebook\.com\/video/i,idRgx:/(?:v=)([a-zA-Z0-9_]+)/i,src:"http://www.facebook.com/v/[id]"},metacafe:{siteRgx:/metacafe\.com\/watch/i,idRgx:/(?:watch\/)([a-zA-Z0-9_]+)/i,src:"http://www.metacafe.com/fplayer/[id]/.swf"},google:{siteRgx:/google\.com\/videoplay/i,idRgx:/(?:id=)([a-zA-Z0-9_\-]+)/i,src:"http://video.google.com/googleplayer.swf?docId=[id]&hl=en&fs=true",flashvars:{playerMode:"normal",fs:!0}},spike:{siteRgx:/spike\.com\/video|ifilm\.com\/video/i,
idRgx:/(?:\/)([0-9]+)/i,src:"http://www.spike.com/efp",flashvars:{flvbaseclip:"[id]"}},dailymotion:{siteRgx:/dailymotion\.com\/video/i,idRgx:/(?:video\/)([a-zA-Z0-9_]+)/i,src:"http://www.dailymotion.com/swf/[id]&related=0&autoplay=1"},cnn:{siteRgx:/cnn\.com\/video/i,idRgx:/(?:\?\/video\/)([a-zA-Z0-9_\/\.]+)/i,src:"http://i.cdn.turner.com/cnn/.element/apps/cvp/3.0/swf/cnn_416x234_embed.swf?context=embed&videoId=[id]",width:416,height:374}};a.fn.ceebox.overlay=function(d){d=a.extend({width:60,height:30,
type:"html"},a.fn.ceebox.defaults,d);0===a("#cee_overlay").size()&&a("<div id='cee_overlay'></div>").css({opacity:d.overlayOpacity,position:"absolute",top:0,left:0,backgroundColor:d.overlayColor,width:"100%",height:a(document).height(),zIndex:100}).appendTo(a("body"));if(0===a("#cee_box").size()){var b=q(d),b={position:b.position,zIndex:102,top:"50%",left:"50%",height:d.height+"px",width:d.width+"px",marginLeft:b.mleft+"px",marginTop:b.mtop+"px",opacity:0,borderWidth:d.borderWidth,backgroundColor:d.boxColor,
color:d.textColor};a("<div id='cee_box'></div>").css(b).appendTo("body").animate({opacity:1},d.animSpeed,function(){a("#cee_overlay").addClass("cee_close")})}a("#cee_box").removeClass().addClass("cee_"+d.type);0===a("#cee_load").size()&&a(a.fn.ceebox.loader).appendTo("body");a("#cee_load").show("fast").animate({opacity:1},"fast")};a.fn.ceebox.popup=function(d,b){var c=p(b.margin),b=a.extend({width:c.width,height:c.height,modal:!1,type:"html",onload:null},a.fn.ceebox.defaults,b),e;if(a(d).is("a,area,input")&&
("html"==b.type||"image"==b.type||"video"==b.type))b.gallery&&(e=a(b.selector).eq(b.gallery.parentId).find("a[href],area[href],input[href]")),r[b.type].prototype=new w(d,b),c=new r[b.type],d=c.content,b.action=c.action,b.modal=c.modal,b.titles?(b.titleHeight=a(c.titlebox).contents().contents().wrap("<div></div>").parent().attr("id","ceetitletest").css({position:"absolute",top:"-300px",width:c.width+"px"}).appendTo("body").height(),a("#ceetitletest").remove(),b.titleHeight=10<=b.titleHeight?b.titleHeight+
20:30):b.titleHeight=0,b.width=c.width+2*b.padding,b.height=c.height+b.titleHeight+2*b.padding;a.fn.ceebox.overlay(b);h.action=b.action;h.onload=b.onload;h.unload=b.unload;c=q(b);c={marginLeft:c.mleft,marginTop:c.mtop,width:b.width+"px",height:b.height+"px"};a("#cee_box").css("borderLeftWidth")!=b.borderWidth&&(c=b.boxColor?a.extend(c,{borderWidth:b.borderWidth}):c);v(c);c=b.textColor?a.extend(c,{color:b.textColor}):c;c=b.boxColor?a.extend(c,{backgroundColor:b.boxColor}):c;a("#cee_box").animate(c,
b.animSpeed,b.easing,function(){var c=a(this).append(d).children().hide(),j=c.length,i=!0;c.fadeIn(b.fadeIn,function(){a(this).is("#cee_iframeContent")&&(i=!1);if(i&&this==c[j-1])a.fn.ceebox.onload()});!0===b.modal?a("#cee_overlay").removeClass("cee_close"):(a("<a href='#' id='cee_closeBtn' class='cee_close' title='Close'>close</a>").prependTo("#cee_box"),b.gallery&&u(b.gallery,e,b),t(void 0,e,b.fadeOut))})};a.fn.ceebox.closebox=function(d,b){d=d||400;a("#cee_box").fadeOut(d);a("#cee_overlay").fadeOut("number"==
typeof d?2*d:"slow",function(){a("#cee_box,#cee_overlay,#cee_HideSelect,#cee_load").unbind().trigger("unload").remove();l(b)?b():l(h.unload)&&h.unload();h.unload=null});document.onkeydown=null};a.fn.ceebox.onload=function(){a("#cee_load").hide(300).fadeOut(600,function(){a(this).remove()});l(h.action)&&(h.action(),h.action=null);l(h.onload)&&(h.onload(),h.onload=null)};var h={},s=function(d,b,c){var e,g=[],j=[],i=0;a(d).is("[href]")?e=a(d):e=a(d).find("[href]");var f={image:function(a,b){return b&&
b.match(/\bimage\b/i)?!0:a.match(/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/i)||!1},video:function(a,b){return b&&b.match(/\bvideo\b/i)?!0:a.match(h.vidRegex)||!1},html:function(){return!0}};e.each(function(b){var d=this,e=a.metadata?a(d).metadata():!1,i=e?a.extend({},c,e):c;a.each(f,function(c){if(f[c](a(d).attr("href"),a(d).attr("rel"))&&i[c]){var e=!1;!0===i[c+"Gallery"]&&(j[j.length]=b,e=!0);g[g.length]={linkObj:d,type:c,gallery:e,linkOpts:i};return!1}})});var o=j.length;a.each(g,function(c){if(g[c].gallery){var e=
{parentId:b,gNum:i,gLen:o};0<i&&(e.prevId=j[i-1]);i<o-1&&(e.nextId=j[i+1]);i++}!a.support.opacity&&a(d).is("map")&&a(g[c].linkObj).click(function(a){a.preventDefault()});a.data(g[c].linkObj,"ceebox",{type:g[c].type,opts:g[c].linkOpts,gallery:e})})},w=function(d,b){var c=b[b.type+"Width"],e=b[b.type+"Height"],g=b[b.type+"Ratio"]||c/e,j=a(d).attr("href");j.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i);var g=b.videoRatio,c=b.videoWidth,e=b.videoHeight,i=a(d).attr("rel");if(i&&""!==i){var f={};a.each(a.fn.ceebox.relMatch,
function(a,b){f[a]=b.exec(i)});f.modal&&(b.modal=!0);f.nonmodal&&(b.modal=!1);f.width&&(c=Number(k(f.width)));f.height&&(e=Number(k(f.height)));f.ratio&&(g=k(f.ratio),g=Number(g)?Number(g):""+g);f.videoSrc&&(this.videoSrc=""+k(f.videoSrc));f.videoId&&(this.videoId=""+k(f.videoId));f.start&&(this.startTime=Number(k(f.start)))}var h=p(b.margin),c=c&&c<h.width||!h.width?c:h.width,e=e&&e<h.height||!h.height?e:h.height;g&&(Number(g)||(g=a.fn.ceebox.ratios[g]?Number(a.fn.ceebox.ratios[g]):1),c/e>g&&(c=
parseInt(e*g,10)),c/e<g&&(e=parseInt(c/g,10)));this.modal=b.modal;this.href=j;this.title=a(d).attr("title")||d.t||"";this.titlebox=b.titles?"<div id='cee_title'><h2>"+this.title+"</h2></div>":"";this.width=c;this.height=e;this.rel=i;this.iPhoneRedirect=b.iPhoneRedirect},r={image:function(){this.content="<img id='cee_img' src='"+this.href+"' width='"+this.width+"' height='"+this.height+"' alt='"+this.title+"'/>"+this.titlebox},video:function(){var d="",b=this,c=function(){var c=this,d=b.videoId;c.flashvars=
c.param={};c.src=b.videoSrc||b.href;c.width=b.width;c.height=b.height;a.each(a.fn.ceebox.videos,function(e,f){if(f.siteRgx&&"string"!=typeof f.siteRgx&&f.siteRgx.test(b.href)){f.idRgx&&(f.idRgx=RegExp(f.idRgx),d=""+k(f.idRgx.exec(b.href)));c.src=f.src?f.src.replace("[id]",d):c.src;var h=RegExp(/(?:t=)+([0-9]+)s/i),l=RegExp(/(?:t=)+([0-9]+)m/i).exec(b.href),h=h.exec(b.href),m=0;l&&(m=60*Number(l[1]));h&&(m+=Number(h[1]));f.flashvars&&a.each(f.flashvars,function(a,b){typeof b=="string"&&(c.flashvars[a]=
b.replace("[id]",d))});f.param&&a.each(f.param,function(a,b){typeof b=="string"&&(c.param[a]=b.replace("[id]",d))});if(b.startTime||m)c.param.start=m||b.startTime;c.width=f.width||c.width;c.height=f.height||c.height;c.site=e}});return c}();if(a.flash.hasVersion(8))this.width=c.width,this.height=c.height,this.action=function(){a("#cee_vid").flash({swf:c.src,params:a.extend(a.fn.ceebox.videos.base.param,c.param),flashvars:a.extend(a.fn.ceebox.videos.base.flashvars,c.flashvars),width:c.width,height:c.height})};
else if(this.width=400,this.height=200,h.userAgent.match(/iPhone/i)&&this.iPhoneRedirect||h.userAgent.match(/iPod/i)&&this.iPhoneRedirect){var e=this.href;this.action=function(){a.fn.ceebox.closebox(400,function(){window.location=e})}}else c.site=c.site||"SWF file",d="<p style='margin:20px'>Adobe Flash 8 or higher is required to view this movie. You can either:</p><ul><li>Follow link to <a href='"+this.href+"'>"+c.site+" </a></li><li>or <a href='http://www.adobe.com/products/flashplayer/'>Install Flash</a></li><li> or <a href='#' class='cee_close'>Close This Popup</a></li></ul>";
this.content="<div id='cee_vid' style='width:"+this.width+"px;height:"+this.height+"px;'>"+d+"</div>"+this.titlebox},html:function(){var d=this.href,b=this.rel,c=[d.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i),d.match(/^http:+/),b?b.match(/^iframe/):!1];if(document.domain==c[0]&&c[1]&&!c[2]||!c[1]&&!c[2]){var e,g=(e=d.match(/#[a-zA-Z0-9_\-]+/))?""+(d.split("#")[0]+" "+e):d;this.action=function(){a("#cee_ajax").load(g)};this.content=this.titlebox+"<div id='cee_ajax' style='width:"+(this.width-30)+"px;height:"+
(this.height-20)+"px'></div>"}else{b="";if("www.youtube.com"==c[0])b="youtube-player",e=RegExp(/(?:v=)([a-zA-Z0-9_\-]+)/i),e=""+k(e.exec(d)),d="http://www.youtube.com/embed/"+e;else if("vimeo.com"==c[0]||"www.vimeo.com"==c[0])e=RegExp(/(?:\.com\/)([a-zA-Z0-9_]+)/i),e=""+k(e.exec(d)),d="http://player.vimeo.com/video/"+e+"?color=ff9933";a("#cee_iframe").remove();this.content=this.titlebox+"<iframe src='"+d+"' frameborder='0' type='text/html' id='cee_iframeContent' class='"+b+"' name='cee_iframeContent"+
Math.round(1E3*Math.random())+"' onload='jQuery.fn.ceebox.onload()' style='width:"+this.width+"px;height:"+this.height+"px;' webkitAllowFullScreen mozallowfullscreen allowFullScreen> </iframe>"}}}})(jQuery);