//ceebox
/*
 * CeeBox 2.1.5.3 jQuery Plugin (minimized version)
 * Requires jQuery 1.3.2 and swfobject.jquery.js plugin to work
 * Code hosted on GitHub (http://github.com/catcubed/ceebox) Please visit there for version history information
 * By Colin Fahrion (http://www.catcubed.com)
 * Inspiration for ceebox comes from Thickbox (http://jquery.com/demo/thickbox/) and Videobox (http://videobox-lb.sourceforge.net/)
 * However, along the upgrade path ceebox has morphed a long way from those roots.
 * Copyright (c) 2009 Colin Fahrion
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*/

(function(a){function o(d,b,c){j.vidRegex=function(){var b="";a.each(a.fn.ceebox.videos,function(a,d){if(null!==d.siteRgx&&"string"!==typeof d.siteRgx){var c=""+d.siteRgx;b=b+c.slice(1,c.length-2)+"|"}});return RegExp(b+"\\.swf$","i")}();j.userAgent=navigator.userAgent;a(".cee_close").die().live("click",function(){a.fn.ceebox.closebox();return!1});!1!=c&&a(d).each(function(a){s(this,a,b,c)});a(d).live("click",function(d){var c=a(d.target).closest("[href]"),i=c.data("ceebox");if(i){var g=i.opts?a.extend({},
b,i.opts):b;a.fn.ceebox.overlay(g);if("image"==i.type){var h=new Image;h.onload=function(){var b=h.width,d=h.height;g.imageWidth=b&&b<a.fn.ceebox.defaults.imageWidth||!a.fn.ceebox.defaults.imageWidth?b:a.fn.ceebox.defaults.imageWidth;g.imageHeight=d&&d<a.fn.ceebox.defaults.imageHeight||!a.fn.ceebox.defaults.imageHeight?d:a.fn.ceebox.defaults.imageHeight;g.imageRatio=b/d;a.fn.ceebox.popup(c,a.extend(g,{type:i.type},{gallery:i.gallery}))};h.src=a(c).attr("href")}else a.fn.ceebox.popup(c,a.extend(g,
{type:i.type},{gallery:i.gallery}));return!1}})}function p(a){var b=document.documentElement,a=a||100;this.width=(window.innerWidth||self.innerWidth||b&&b.clientWidth||document.body.clientWidth)-a;this.height=(window.innerHeight||self.innerHeight||b&&b.clientHeight||document.body.clientHeight)-a;return this}function q(d){var b="fixed",c=0,e;e=d.borderWidth.match(/[0-9]+/g);var f=[],i=e.length;1<i?(f[0]=e[0],f[1]=e[1],f[2]=2==i?e[0]:e[2],f[3]=4==i?e[3]:e[1]):f=[e,e,e,e];e=f;window.XMLHttpRequest||
(null===a("#cee_HideSelect")&&a("body").append("<iframe id='cee_HideSelect'></iframe>"),b="absolute",c=parseInt(document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,10));this.mleft=parseInt(-1*(d.width/2+Number(e[3])),10);this.mtop=parseInt(-1*(d.height/2+Number(e[0])),10)+c;this.position=b;return this}function t(){document.onkeydown=function(d){d=d||window.event;switch(d.keyCode||d.which){case 13:return!1;case 27:a.fn.ceebox.closebox();document.onkeydown=null;break;
case 188:case 37:a("#cee_prev").trigger("click");break;case 190:case 39:a("#cee_next").trigger("click")}return!0}}function u(d,b,c){function e(d,f){var e,g=h[c.type].bgtop,i=g-2E3;"prev"==d?e=[{left:0},"left"]:e=[{right:0},x="right"];var j=function(b){return a.extend({zIndex:105,width:h[c.type].w+"px",height:h[c.type].h+"px",position:"absolute",top:h[c.type].top,backgroundPosition:e[1]+" "+b+"px"},e[0])};a("<a href='#'></a>").text(d).attr({id:"cee_"+d}).css(j(i)).hover(function(){a(this).css(j(g))},
function(){a(this).css(j(i))}).one("click",function(d){d.preventDefault();(function(b,d,c){a("#cee_prev,#cee_next").unbind().click(function(){return!1});document.onkeydown=null;var f=a("#cee_box").children(),e=f.length;f.fadeOut(c,function(){a(this).remove();this==f[e-1]&&b.eq(d).trigger("click")})})(b,f,c.fadeOut)}).appendTo("#cee_box")}var f=c.height,i=c.titleHeight,g=c.padding,h={image:{w:parseInt(c.width/2,10),h:f-i-2*g,top:g,bgtop:(f-i-2*g)/2},video:{w:60,h:80,top:parseInt((f-i-10-2*g)/2,10),
bgtop:24}};h.html=h.video;0<=d.prevId&&e("prev",d.prevId);d.nextId&&e("next",d.nextId);a("#cee_title").append("<div id='cee_count'>Item "+(d.gNum+1)+" of "+d.gLen+"</div>")}function n(a){return"function"==typeof a}function l(a){var b=a.length;return 1<b?a[b-1]:a}a.ceebox={version:"2.1.5.3"};a.fn.ceebox=function(d){var d=a.extend({selector:a(this).selector},a.fn.ceebox.defaults,d),b=this,c=a(this).selector;d.videoJSON?a.getJSON(d.videoJSON,function(e){a.extend(a.fn.ceebox.videos,e);o(b,d,c)}):o(b,
d,c);return this};a.fn.ceebox.defaults={html:!0,image:!0,video:!0,modal:!1,titles:!0,htmlGallery:!0,imageGallery:!0,videoGallery:!0,videoWidth:!1,videoHeight:!1,videoRatio:"16:9",htmlWidth:!1,htmlHeight:!1,htmlRatio:!1,imageWidth:!1,imageHeight:!1,animSpeed:"normal",easing:"swing",fadeOut:400,fadeIn:400,overlayColor:"#000",overlayOpacity:0.8,boxColor:"",textColor:"",borderWidth:"3px",padding:15,margin:150,onload:null,unload:null,videoJSON:null,iPhoneRedirect:!0};a.fn.ceebox.ratios={"4:3":1.333,"3:2":1.5,
"16:9":1.778,"1:1":1,square:1};a.fn.ceebox.relMatch={width:/(?:width:)([0-9]+)/i,height:/(?:height:)([0-9]+)/i,ratio:/(?:ratio:)([0-9\.:]+)/i,modal:/modal:true/i,nonmodal:/modal:false/i,videoSrc:/(?:videoSrc:)(http:[\/\-\._0-9a-zA-Z:]+)/i,videoId:/(?:videoId:)([\-\._0-9a-zA-Z:]+)/i,start:/(?:start:)([0-9]+)/i};a.fn.ceebox.loader="<div id='cee_load' style='z-index:105;top:50%;left:50%;position:fixed'></div>";a.fn.ceebox.videos={base:{param:{wmode:"transparent",allowFullScreen:"true",allowScriptAccess:"always"},
flashvars:{autoplay:!0}},facebook:{siteRgx:/facebook\.com\/video/i,idRgx:/(?:v=)([a-zA-Z0-9_]+)/i,src:"http://www.facebook.com/v/[id]"},metacafe:{siteRgx:/metacafe\.com\/watch/i,idRgx:/(?:watch\/)([a-zA-Z0-9_]+)/i,src:"http://www.metacafe.com/fplayer/[id]/.swf"},google:{siteRgx:/google\.com\/videoplay/i,idRgx:/(?:id=)([a-zA-Z0-9_\-]+)/i,src:"http://video.google.com/googleplayer.swf?docId=[id]&hl=en&fs=true",flashvars:{playerMode:"normal",fs:!0}},spike:{siteRgx:/spike\.com\/video|ifilm\.com\/video/i,
idRgx:/(?:\/)([0-9]+)/i,src:"http://www.spike.com/efp",flashvars:{flvbaseclip:"[id]"}},dailymotion:{siteRgx:/dailymotion\.com\/video/i,idRgx:/(?:video\/)([a-zA-Z0-9_]+)/i,src:"http://www.dailymotion.com/swf/[id]&related=0&autoplay=1"},cnn:{siteRgx:/cnn\.com\/video/i,idRgx:/(?:\?\/video\/)([a-zA-Z0-9_\/\.]+)/i,src:"http://i.cdn.turner.com/cnn/.element/apps/cvp/3.0/swf/cnn_416x234_embed.swf?context=embed&videoId=[id]",width:416,height:374}};a.fn.ceebox.overlay=function(d){d=a.extend({width:60,height:30,
type:"html"},a.fn.ceebox.defaults,d);0===a("#cee_overlay").size()&&a("<div id='cee_overlay'></div>").css({opacity:d.overlayOpacity,position:"absolute",top:0,left:0,backgroundColor:d.overlayColor,width:"100%",height:a(document).height(),zIndex:100}).appendTo(a("body"));if(0===a("#cee_box").size()){var b=q(d),b={position:b.position,zIndex:102,top:"50%",left:"50%",height:d.height+"px",width:d.width+"px",marginLeft:b.mleft+"px",marginTop:b.mtop+"px",opacity:0,borderWidth:d.borderWidth,backgroundColor:d.boxColor,
color:d.textColor};a("<div id='cee_box'></div>").css(b).appendTo("body").animate({opacity:1},d.animSpeed,function(){a("#cee_overlay").addClass("cee_close")})}a("#cee_box").removeClass().addClass("cee_"+d.type);0===a("#cee_load").size()&&a(a.fn.ceebox.loader).appendTo("body");a("#cee_load").show("fast").animate({opacity:1},"fast")};a.fn.ceebox.popup=function(d,b){var c=p(b.margin),b=a.extend({width:c.width,height:c.height,modal:!1,type:"html",onload:null},a.fn.ceebox.defaults,b),e;if(a(d).is("a,area,input")&&
("html"==b.type||"image"==b.type||"video"==b.type))b.gallery&&(e=a(b.selector).eq(b.gallery.parentId).find("a[href],area[href],input[href]")),r[b.type].prototype=new v(d,b),c=new r[b.type],d=c.content,b.action=c.action,b.modal=c.modal,b.titles?(b.titleHeight=a(c.titlebox).contents().contents().wrap("<div></div>").parent().attr("id","ceetitletest").css({position:"absolute",top:"-300px",width:c.width+"px"}).appendTo("body").height(),a("#ceetitletest").remove(),b.titleHeight=10<=b.titleHeight?b.titleHeight+
20:30):b.titleHeight=0,b.width=c.width+2*b.padding,b.height=c.height+b.titleHeight+2*b.padding;a.fn.ceebox.overlay(b);j.action=b.action;j.onload=b.onload;j.unload=b.unload;c=q(b);c={marginLeft:c.mleft,marginTop:c.mtop,width:b.width+"px",height:b.height+"px"};a("#cee_box").css("borderLeftWidth")!=b.borderWidth&&(c=b.boxColor?a.extend(c,{borderWidth:b.borderWidth}):c);c=b.textColor?a.extend(c,{color:b.textColor}):c;c=b.boxColor?a.extend(c,{backgroundColor:b.boxColor}):c;a("#cee_box").animate(c,b.animSpeed,
b.easing,function(){var c=a(this).append(d).children().hide(),i=c.length,g=!0;c.fadeIn(b.fadeIn,function(){a(this).is("#cee_iframeContent")&&(g=!1);if(g&&this==c[i-1])a.fn.ceebox.onload()});!0===b.modal?a("#cee_overlay").removeClass("cee_close"):(a("<a href='#' id='cee_closeBtn' class='cee_close' title='Close'>close</a>").prependTo("#cee_box"),b.gallery&&u(b.gallery,e,b),t(void 0,e,b.fadeOut))})};a.fn.ceebox.closebox=function(d,b){d=d||400;a("#cee_box").fadeOut(d);a("#cee_overlay").fadeOut("number"==
typeof d?2*d:"slow",function(){a("#cee_box,#cee_overlay,#cee_HideSelect,#cee_load").unbind().trigger("unload").remove();n(b)?b():n(j.unload)&&j.unload();j.unload=null});document.onkeydown=null};a.fn.ceebox.onload=function(){a("#cee_load").hide(300).fadeOut(600,function(){a(this).remove()});n(j.action)&&(j.action(),j.action=null);n(j.onload)&&(j.onload(),j.onload=null)};var j={},s=function(d,b,c){var e,f=[],i=[],g=0;a(d).is("[href]")?e=a(d):e=a(d).find("[href]");var h={image:function(a,b){return b&&
b.match(/\bimage\b/i)?!0:a.match(/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/i)||!1},video:function(a,b){return b&&b.match(/\bvideo\b/i)?!0:a.match(j.vidRegex)||!1},html:function(){return!0}};e.each(function(b){var d=this,e=a.metadata?a(d).metadata():!1,g=e?a.extend({},c,e):c,k=a(d).attr("href"),j=a(d).attr("rel"),l=k.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i);a.each(h,function(a){var c=g[a];if("youtube.com"==l||"www.youtube.com"==l||"vimeo.com"==l||"www.vimeo.com"==l)c=!0;if(h[a](k,j)&&c)return c=!1,!0===
g[a+"Gallery"]&&(i[i.length]=b,c=!0),f[f.length]={linkObj:d,type:a,gallery:c,linkOpts:g},!1})});var k=i.length;a.each(f,function(c){if(f[c].gallery){var e={parentId:b,gNum:g,gLen:k};0<g&&(e.prevId=i[g-1]);g<k-1&&(e.nextId=i[g+1]);g++}!a.support.opacity&&a(d).is("map")&&a(f[c].linkObj).click(function(a){a.preventDefault()});a.data(f[c].linkObj,"ceebox",{type:f[c].type,opts:f[c].linkOpts,gallery:e})})},v=function(d,b){var c=b[b.type+"Width"],e=b[b.type+"Height"],f=b[b.type+"Ratio"]||c/e,i=a(d).attr("href"),
g=i.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i);if("youtube.com"==g||"www.youtube.com"==g||"vimeo.com"==g||"www.vimeo.com"==g)f=b.videoRatio,c=b.videoWidth,e=b.videoHeight;var h=a(d).attr("rel");if(h&&""!==h){var k={};a.each(a.fn.ceebox.relMatch,function(a,b){k[a]=b.exec(h)});k.modal&&(b.modal=!0);k.nonmodal&&(b.modal=!1);k.width&&(c=Number(l(k.width)));k.height&&(e=Number(l(k.height)));k.ratio&&(f=l(k.ratio),f=Number(f)?Number(f):""+f);k.videoSrc&&(this.videoSrc=""+l(k.videoSrc));k.videoId&&(this.videoId=
""+l(k.videoId));k.start&&(this.startTime=Number(l(k.start)))}g=p(b.margin);c=c&&c<g.width||!g.width?c:g.width;e=e&&e<g.height||!g.height?e:g.height;f&&(Number(f)||(f=a.fn.ceebox.ratios[f]?Number(a.fn.ceebox.ratios[f]):1),c/e>f&&(c=parseInt(e*f,10)),c/e<f&&(e=parseInt(c/f,10)));this.modal=b.modal;this.href=i;this.title=a(d).attr("title")||d.t||"";this.titlebox=b.titles?"<div id='cee_title'><h2>"+this.title+"</h2></div>":"";this.width=c;this.height=e;this.rel=h;this.iPhoneRedirect=b.iPhoneRedirect},
r={image:function(){this.content="<img id='cee_img' src='"+this.href+"' width='"+this.width+"' height='"+this.height+"' alt='"+this.title+"'/>"+this.titlebox},video:function(){var d="",b=this,c=function(){var c=this,d=b.videoId;c.flashvars=c.param={};c.src=b.videoSrc||b.href;c.width=b.width;c.height=b.height;a.each(a.fn.ceebox.videos,function(e,h){if(h.siteRgx&&"string"!=typeof h.siteRgx&&h.siteRgx.test(b.href)){h.idRgx&&(h.idRgx=RegExp(h.idRgx),d=""+l(h.idRgx.exec(b.href)));c.src=h.src?h.src.replace("[id]",
d):c.src;var k=RegExp(/(?:t=)+([0-9]+)s/i),j=RegExp(/(?:t=)+([0-9]+)m/i).exec(b.href),k=k.exec(b.href),m=0;j&&(m=60*Number(j[1]));k&&(m+=Number(k[1]));h.flashvars&&a.each(h.flashvars,function(a,b){typeof b=="string"&&(c.flashvars[a]=b.replace("[id]",d))});h.param&&a.each(h.param,function(a,b){typeof b=="string"&&(c.param[a]=b.replace("[id]",d))});if(b.startTime||m)c.param.start=m||b.startTime;c.width=h.width||c.width;c.height=h.height||c.height;c.site=e}});return c}();if(a.flash.hasVersion(8))this.width=
c.width,this.height=c.height,this.action=function(){a("#cee_vid").flash({swf:c.src,params:a.extend(a.fn.ceebox.videos.base.param,c.param),flashvars:a.extend(a.fn.ceebox.videos.base.flashvars,c.flashvars),width:c.width,height:c.height})};else if(this.width=400,this.height=200,j.userAgent.match(/iPhone/i)&&this.iPhoneRedirect||j.userAgent.match(/iPod/i)&&this.iPhoneRedirect){var e=this.href;this.action=function(){a.fn.ceebox.closebox(400,function(){window.location=e})}}else c.site=c.site||"SWF file",
d="<p style='margin:20px'>Adobe Flash 8 or higher is required to view this movie. You can either:</p><ul><li>Follow link to <a href='"+this.href+"'>"+c.site+" </a></li><li>or <a href='http://www.adobe.com/products/flashplayer/'>Install Flash</a></li><li> or <a href='#' class='cee_close'>Close This Popup</a></li></ul>";this.content="<div id='cee_vid' style='width:"+this.width+"px;height:"+this.height+"px;'>"+d+"</div>"+this.titlebox},html:function(){var d=this.href,b=this.rel,c=[d.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i),
d.match(/^https?:+/),b?b.match(/^iframe/):!1];if(document.domain==c[0]&&c[1]&&!c[2]||!c[1]&&!c[2]){var e,f=(e=d.match(/#[a-zA-Z0-9_\-]+/))?""+(d.split("#")[0]+" "+e):d;this.action=function(){a("#cee_ajax").load(f)};this.content=this.titlebox+"<div id='cee_ajax' style='width:"+(this.width-30)+"px;height:"+(this.height-20)+"px'></div>"}else{b="";if("www.youtube.com"==c[0])b="youtube-player",e=RegExp(/(?:v=)([a-zA-Z0-9_\-]+)/i),e=""+l(e.exec(d)),d="http://www.youtube.com/embed/"+e+"?wmode=transparent";
else if("vimeo.com"==c[0]||"www.vimeo.com"==c[0])e=RegExp(/(?:\.com\/)([a-zA-Z0-9_]+)/i),e=""+l(e.exec(d)),d="http://player.vimeo.com/video/"+e+"?color=ff9933&amp;wmode=transparent";a("#cee_iframe").remove();this.content=this.titlebox+"<iframe src='"+d+"' frameborder='0' type='text/html' id='cee_iframeContent' class='"+b+"' name='cee_iframeContent"+Math.round(1E3*Math.random())+"' onload='jQuery.fn.ceebox.onload()' style='width:"+this.width+"px;height:"+this.height+"px;' webkitAllowFullScreen mozallowfullscreen allowFullScreen> </iframe>"}}}})(jQuery);